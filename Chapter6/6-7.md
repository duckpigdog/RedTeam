### Windows 计划任务后门

计划任务在 Windows 7 及之前版本的操作系统中使用 `at` 命令调用

在从 Windows 8 版本开始的操作系统中使用`schtasks` 命令调用

计划任务后门分为管理员权限和普通用户权限两种。管理员权限的后门可以设置更多的计划任务，例如重启后运行等

**请先提前在 CS 上监听并生成木马**

![](https://pic1.imgdb.cn/item/68d548abc5157e1a88324231.png)

![](https://pic1.imgdb.cn/item/68d54897c5157e1a883241aa.png)

创建任务

```cmd
shell schtasks /create /tn transfer /tr c:\c.exe /ru system /sc MINUTE /mo 1 /f
```

`shell schtasks /create`: 创建一个定时任务

`/tn transfer`: 任务名为 `transfer`

`/tr c:\c.exe`: 任务执行的程序是 `c:\c.exe`

`/ru system`: 任务以 **`SYSTEM`** 最高权限运行

`/sc MINUTE`: 设置任务的计划类型为**分钟**

`/mo 1`: `mo` 是 `modifier` 的缩写，表示每 **1** 分钟运行一次

`/f`: 强制创建，如果同名任务已存在则覆盖

![](https://pic1.imgdb.cn/item/68d54832c5157e1a88323f2c.png)

删除任务

```cmd
shell schtasks /delete /tn transfer
```

![](https://pic1.imgdb.cn/item/68d5487cc5157e1a883240f4.png)

图像化版创建定时任务

![](https://pic1.imgdb.cn/item/68d548dfc5157e1a883243f9.png)

找到刚刚生成的定时任务了

![](https://pic1.imgdb.cn/item/68d54900c5157e1a88324506.png)

在右边点击创建任务

![](https://pic1.imgdb.cn/item/68d5494cc5157e1a88324545.png)

常规页面选择不管用户是否登录都要运行

![](https://pic1.imgdb.cn/item/68d5497bc5157e1a88324581.png)

触发器选择登录时

![](https://pic1.imgdb.cn/item/68d54a3ac5157e1a88324609.png)

操作选择启动我们的木马

![](https://pic1.imgdb.cn/item/68d54a65c5157e1a88324643.png)

最后输入密码

![](https://pic1.imgdb.cn/item/68d54a8ac5157e1a88324666.png)

可以看到正在准备就绪了

![](https://pic1.imgdb.cn/item/68d54a9dc5157e1a8832466e.png)

重新登录成功上线

![](https://pic1.imgdb.cn/item/68d54afbc5157e1a883246b4.png)
