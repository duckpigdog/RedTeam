### Windows Everything 服务权限维持

**为什么要用 everything 维权**

在内网中, 一些凭证的收集、配置文件、密码本的获取，往往是在内网中非常有价值的利用信息

在自己 VPS 上我们经常使用 Python 开启 Web 服务用来下载文件

但是内网机器中不一定有 Python 环境, 我们可以通过 Everything 开启 HTTP 服务，以及本身自带的搜索功能，然后利用端口转发把内网机器上的服务转发到公网访问

下载便携版的 Everything，然后去设置，启用 HTTP 服务器打开应用

选择工具，选项

![](https://pic1.imgdb.cn/item/68d5fb29c5157e1a883385e0.png)

然后将配置文件 `everything.ini`，和便携版的 everything  一同上传到目标机器

访问 http://127.0.0.1:20050 这样就可以在目标机器上搜索、下载文件了

![](https://pic1.imgdb.cn/item/68d5fc87c5157e1a8833985c.png)

[下载 NPS](https://github.com/ehang-io/nps/releases/tag/v0.26.10)

```sh
tar -xzvf linux_amd64_server.tar.gz
./nps install
```

如果运行时端口冲突则需要修改 `/etc/nps/conf/nps,conf` 文件

![](https://pic1.imgdb.cn/item/68d6015bc5157e1a8833f76c.png)

修改账号密码

![](https://pic1.imgdb.cn/item/68d602fdc5157e1a8834163a.png)

启动

![](https://pic1.imgdb.cn/item/68d60181c5157e1a8833f9e2.png)

新增 TCP 隧道

![](https://pic1.imgdb.cn/item/68d604b0c5157e1a88343300.png)

这时候成功将 **20050 端口转发到了该地址，我们直接在互联网访问便可以实现文件搜索和下载了**
