### MS16-075 JuicyPotato 提权（CS）

土豆家族的提权也是基于内核漏洞的提权，之所以把他单独拿出来说，主要是因为这个家族的漏洞影响 较大已经可以 "自成一派"

JuicyPotato 属于“**Token-impersonation（令牌模拟/窃取）+ NTLM 反射/转发**”这一类本地提权技术家族。它不是通过内核漏洞直接写内存，而是**利用系统里能以 SYSTEM 身份进行网络认证或 RPC 调用的服务（含 DCOM/RPC/其它 COM 服务）**，诱使该服务对攻击者控制的伪造端点进行 NTLM 身份验证，然后把获得的高权限令牌用于模拟/提升到 SYSTEM，从而把本地进程提升为 SYSTEM

创建监听器

![](https://pic1.imgdb.cn/item/68d0d248c5157e1a88247038.png)

生成一个后门

![](https://pic1.imgdb.cn/item/68d0d284c5157e1a882470b6.png)

靶机访问运行

![](https://pic1.imgdb.cn/item/68d0d2a8c5157e1a882470e6.png)

上线成功

![](https://pic1.imgdb.cn/item/68d0d2c1c5157e1a88247104.png)

使用 MS16-075 提权

![](https://pic1.imgdb.cn/item/68d0d2ecc5157e1a8824712b.png)

提权成功

![](https://pic1.imgdb.cn/item/68d0d325c5157e1a8824716e.png)
