### 清除 Windows 系统日志

**系统日志**

记录操作系统组件产生的事件，主要包括驱动程序、系统组件和应用软件的崩溃

```cmd
c:\windows\system32\winevt\Logs\System.evtx
%SystemRoot%\System32\Winevt\Logs\System.evtx
```

**应用程序日志**

包含应用程序或系统程序记录的事件，主要记录程序运行方面的事件

```
c:\windows\system32\winevt\Logs\Application.evtx
%SystemRoot%\System32\Winevt\Logs\Application.evtx
```

**安全日志**

记录系统的安全审计事件，包含各种类型的登陆日志、对象访问日志、进程追踪日志、特权使用、账号管理、策略变更和系统事件

```
c:\windows\system32\winevt\Logs\Security.evtx
%SystemRoot%\System32\Winevt\Logs\Security.evtx
```

id 4624 为 RDP 链接登陆成功 , 可以看到客户端的 IP , 可排查爆破 RDP 的攻击者 IP id 4625 为 RDP 链接登陆失败

![](https://pic1.imgdb.cn/item/68d9e88bc5157e1a8842977f.png)

PowerShell 命令一键清除, cmd 下管理员运行

```powershell
PowerShell -Command "& {Get-WinEvent -ListLog Application,System,Security -Force | %
{Wevtutil.exe cl $_.Logname}}"
```

MSF 清除日志命令

```
clearev
```

![](https://pic1.imgdb.cn/item/68d9ea33c5157e1a88429860.png)

`wevtutil+for` 循环清除所有日志

**Wevtutil** 是用来查看事件的系统工具，可以卸载事件清单，导出，归档和清除日志

```cmd
for /F "tokens=*" %a in ('wevtutil.exe el') DO wevtutil.exe cl "%a"
```

[下载 CS 工具](https://github.com/hlldz/Phant0m)

![](https://pic1.imgdb.cn/item/68d9edafc5157e1a884299cb.png)